<extend name="Public/base"/>
<block name="body">
    <!-- S=详情显示 --> 
    <div class="tw-list-wrap" style="margin-top: 20px;">       

        <form action="__ACTION__" method="get" id='frmSearch'>
            <div class="tw-search-bar">
                <div class="search-form fr cf">
                    <div class="sleft">
                        <input type='hidden' name="type" value="{$type}">
                        <input type='hidden' name="imgId" value="{$imgId}">
                        <input type="text" name="keywords" class="search-input" value="{:I('keywords', '')}" placeholder="请输入商品名">
                        <a type="submit" class="sch-btn" onclick="$('#frmSearch').submit();"><i class="btn-search"></i></a>
                    </div>
                </div>
            </div>
        </form>
        <!-- S=表单 -->
        <table class="tw-table tw-table-list tw-table-fixed">
            <thead>
                <tr>
                    <th class="row-selected"></th>
                    <th width="10%">商品ID</th>
                    <th width="15%">商品名称</th>
                    <th width="15%">商品图片</th>
                <tr>
            </thead>
            <!-- S=详细信息 --> 
            <tbody>
                <notempty name="data">
                    <volist name="data" id="vo">
                        <tr>
                            <td><input class="ids row-selected" onclick="checkboxOnclick($(this).val(), $(this).parent().next().next().html(), $(this).parent().next().next().next().children().val())"  type="radio" name="chkbId" value="{$vo.id}"></td>
                            <td id="shopId">{$vo.id}</td>
                            <td>{$vo.attr_value}</td>
                            <td id="shopImg">
                                <input type="hidden" value="{$vo.goods_img}">
                                <img src="{$vo.goods_img}" style="height:100px; width:100px;">
                            </td>
                        </tr>
                    </volist>
                    <else/>
                        <td colspan="4" class="text-center"> aOh! 暂时还没有内容! </td>                            
                </notempty>
            </tbody>
            <!-- E=详细信息 -->
        </table>
        <div class="page">{$page}</div>
    <!-- <div class="tw-tool-bar-bot">
        <button type="button" class="tw-act-btn-cancel">关闭</button>
    </div> -->
</block>

<block name="script">
    <script type="text/javascript">
        $(".tw-act-btn-cancel").click(function(){
            var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
            parent.layer.close(index);
        })
        
        function checkboxOnclick(checkbox, shopName, shopImg){
            var selectedId = {$selectedGoodsId};
            var imgId = "{$imgId}";
            if (imgId == -1) { //-1表示选择商品
                $res = selectedId.indexOf(checkbox);
                if($res !== -1){
                    toastr.error('同一商品不能添加两次推荐模版');
                    return false;
                }
            } 
            parent.getGoodsIdAndImg(checkbox, shopName, shopImg, imgId);
        }        
    </script>
</block>