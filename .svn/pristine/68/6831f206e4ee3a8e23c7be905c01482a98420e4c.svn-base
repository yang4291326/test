<?php
namespace Member\Controller;
use \Think\Controller;
/**
 * Created by PhpStorm.
 * User: YangYongJIE
* Date: 2017/5/15
* Time: 10:59
*/
/*杨yongjie  添加*/
class MobileApiController extends Controller{
    public function getMobileCode(){
        $code=$_POST['code'];
        //var_dump($code);
        if($code==''){
            $this->apiReturn(0,'非法访问');
        }
        $params=json_decode($code,true);
        $_POST=null;
        foreach($params as $k => $v){
            $_POST[$k] = $v;
        }
        if($_POST['type']==1){//1为平板端
//            $arr=array(
//                'port'=>'4321',
//                'machine_code'=>array(
//                    '990005841635932',
//                    '990005841731855'
//                )
//
//            );
            $arr=array(
                        'port'=>'4321',
                      );
            $this->apiReturn(1,'手机端',$arr);
        }elseif($_POST['type']==2){//2为手机端
            $arr=array(
                        'port'=>'1234',
                      );
            $this->apiReturn(1,'平板端',$arr);
        }
    }
    protected function apiReturn($status, $message='', $data=''){
        if ($status != 0 && $status != 1) {
            exit('参数调用错误 status');
        }

        if ($data != '' && C('APP_DATA_ENCODE') == true) {
            $data = json_encode($data); // 数组转为json字符串
            $aes = new \Common\Tools\Aes();
            $data = $aes->aes128cbcEncrypt($data); // 加密
        }

        if (is_null($data) || empty($data)) $data = array();
        $this->ajaxReturn(V($status, $message, $data));
    }
}
/*杨yongjie  添加*/